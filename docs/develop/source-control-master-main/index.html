<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Master to Main branch rename # These instructions will help moving repos from using the default branch name master and modify it to be main.
Prereqs # First, ensure that the version of git that you have installed is at least v2.28.0. This is important to ensure you have access to the init.DefaultBranch setting in the git config file.
Instructions to change default branch name # To update the branch name use the npm tool lgarron/main-branch:"><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content><meta property="og:description" content="Master to Main branch rename # These instructions will help moving repos from using the default branch name master and modify it to be main.
Prereqs # First, ensure that the version of git that you have installed is at least v2.28.0. This is important to ensure you have access to the init.DefaultBranch setting in the git config file.
Instructions to change default branch name # To update the branch name use the npm tool lgarron/main-branch:"><meta property="og:type" content="article"><meta property="og:url" content="https://805th-Shoc.github.io/docs/develop/source-control-master-main/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2023-02-08T15:06:45-08:00"><title>Source Control Master Main | Engineering-Playbook</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.4b35fed0bea034bbc19c89c71e14b73fb9c68cfcc586b9382adfb9b7b103ba06.css integrity="sha256-SzX+0L6gNLvBnInHHhS3P7nGjPzFhrk4Kt+5t7EDugY=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.941313a023209828c887550ad1e6ffb06e03377997c980d428153b11b72ea760.js integrity="sha256-lBMToCMgmCjIh1UK0eb/sG4DN3mXyYDUKBU7Ebcup2A=" crossorigin=anonymous></script>
<script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>Engineering-Playbook</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/>Welcome</a></li><li><a href=/docs/documentation/introduction-to-documentation/>Documentation</a><ul><li><a href=/docs/documentation/introduction-to-documentation/>Introduction to Documentation</a></li><li><a href=/docs/documentation/adr/>Architectural Decision Records</a></li><li><a href=/docs/documentation/external-resources/>External Resources</a></li></ul></li><li><a href=/docs/compliance/information-security-and-federal-compliance/>Security and Compliance</a><ul><li><a href=/docs/compliance/authorization-to-operate/>Authorization to Operate</a></li><li><a href=/docs/compliance/risk-management-framework/>Risk Management Framework</a></li></ul></li><li><a href=/docs/project_management/phases-of-an-agile-project/>Project Management</a><ul><li><a href=/docs/project_management/phases-of-an-agile-project/>Phases of an Agile Project</a><ul><li><a href=/docs/project_management/agile-project-discovery-phase/>Discovery Phase</a></li><li><a href=/docs/project_management/agile-project-prototyping-phase/>Prototyping Phase</a></li><li><a href=/docs/project_management/agile-project-beta-phase/>Beta Phase</a></li><li><a href=/docs/project_management/agile-project-go-live/>Go Live</a></li><li><a href=/docs/project_management/agile-project-hand-off/>Hand Off</a></li></ul></li><li><a href=/docs/project_management/the-steel-cable/>The Steel Cable</a></li><li><a href=/docs/project_management/definition-of-done/>Definition of Done</a></li><li><a href=/docs/project_management/accessibility-standards/>Accessibility Standards</a></li></ul></li><li><a href=/docs/develop/tools-and-practice/>Devloping</a><ul><li><a href=/docs/develop/tools-and-practice/>Tools and Practice</a></li><li><a href=/docs/develop/bugs/>Defects/Bugs</a></li><li><a href=/docs/develop/intro-to-ci-cd/>CI/CD</a><ul><li><a href=/docs/develop/intro-to-ci-cd/>Intro to CI/CD</a></li><li><a href=/docs/develop/standard-delivery-pipeline/>Standard Delivery Pipeline</a></li></ul></li><li><a href=/docs/develop/code-reviews/>Code Reviews</a><ul><li><a href=/docs/develop/great-code-brings-happiness/>Great Code Brings Happiness</a></li><li><a href=/docs/develop/best-practices-for-submitting-pull-requests/>Best Practices for Submitting a Pull Request</a></li></ul></li><li><a href=/>Command Line Tools</a><ul><li><a href=/docs/develop/direnv/>direnv</a></li><li><a href=/docs/develop/docker/>Docker</a></li></ul></li><li><a href=/docs/develop/configuration/>Configuration</a></li><li><a href=/docs/develop/development-cycle/>Development Cycle</a></li><li><a href=/docs/develop/editors-ides-debuggers/>Editors, IDEs and Debuggers</a></li><li><a href=/docs/develop/growth/>Growth</a></li><li><a href=/docs/develop/health-checks/>Health Checks</a></li><li><a href=/docs/develop/programming-languages/>Programming Languages</a><ul><li><a href=/docs/develop/programming-languages-shell/>Shell Programming</a></li><li><a href=/docs/develop/programming-languages-golang/>Golang</a></li><li><a href=/docs/develop/programming-languages-python/>Python</a></li></ul></li><li><a href=/>Learning Resources</a></li><li><a href=/>Open Source</a></li><li><a href=/>Pair Programming</a></li><li><a href=/>Technical Design</a></li><li><a href=/docs/develop/source-control/>Source Control</a></li><li><a href=/>Leadership</a></li></ul></li><li><a href=/docs/infrastructure/>Infrastructure</a><ul><li><a href=/>IaC</a></li></ul></li></ul><br><ul><li><a href=/posts/>Blog</a></li><li><a href=https://github.com/805th-Shoc/805th-Shoc.github.io target=_blank rel=noopener>Github</a></li><li><a href=https://themes.gohugo.io/hugo-book/ target=_blank rel=noopener>Hugo Themes</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Source Control Master Main</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#master-to-main-branch-rename>Master to Main branch rename</a><ul><li><a href=#prereqs>Prereqs</a></li><li><a href=#instructions-to-change-default-branch-name>Instructions to change default branch name</a></li><li><a href=#future-proofing>Future proofing</a></li><li><a href=#github>Github</a></li><li><a href=#circleci-changes>CircleCI Changes</a></li><li><a href=#terraform-registry>Terraform Registry</a></li><li><a href=#ide-changes>IDE Changes</a></li><li><a href=#tooling-changes>Tooling Changes</a></li><li><a href=#references>References</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=master-to-main-branch-rename>Master to Main branch rename
<a class=anchor href=#master-to-main-branch-rename>#</a></h1><p>These instructions will help moving repos from using the default branch name <code>master</code> and modify it to be <code>main</code>.</p><h2 id=prereqs>Prereqs
<a class=anchor href=#prereqs>#</a></h2><p>First, ensure that the version of <code>git</code> that you have installed is at least v2.28.0. This is important to ensure you have access to the
<a href=https://github.blog/2020-07-27-highlights-from-git-2-28/#introducing-init-defaultbranch>init.DefaultBranch</a> setting in the git config file.</p><h2 id=instructions-to-change-default-branch-name>Instructions to change default branch name
<a class=anchor href=#instructions-to-change-default-branch-name>#</a></h2><p>To update the branch name use the npm tool
<a href=https://github.com/lgarron/main-branch>lgarron/main-branch</a>:</p><pre tabindex=0><code>npm install -g main-branch
main-branch trussworks/master-to-main-test replace master main
</code></pre><p>Follow up with local modifications:</p><pre tabindex=0><code>cd git-repo-name
git pull origin main
git checkout main
git branch --delete master
git branch --set-upstream-to=origin/main main
git symbolic-ref HEAD refs/heads/main
git symbolic-ref refs/remotes/origin/HEAD refs/remotes/origin/main
git fetch --all --prune
</code></pre><p>Test that the <code>master</code> branch has been removed by running this command and getting a shell error (exit code not <code>0</code>):</p><pre tabindex=0><code>git checkout master
</code></pre><h2 id=future-proofing>Future proofing
<a class=anchor href=#future-proofing>#</a></h2><p>If you&rsquo;re using <code>git</code> v2.28.0 or later you should be able to configure git globally to ensure <code>main</code> is now your default branch permanently.</p><pre tabindex=0><code>git config --global init.defaultBranch main
</code></pre><p>Now in your <code>~/.gitconfig</code> file you&rsquo;ll see this addition:</p><pre tabindex=0><code>[init]
    defaultBranch = main
</code></pre><p>For older versions of the <code>git</code> tool you&rsquo;ll have to be careful to not create new repos with <code>master</code> as the default branch. First make a new git alias:</p><pre tabindex=0><code>git config --global alias.main &#39;!git init &amp;&amp; git checkout -b main&#39;
git main
</code></pre><p>You can add an alias to your <code>bash</code> or other shell to help:</p><pre tabindex=0><code>alias git_init=&#39;git main&#39;
</code></pre><p>Alternatively use this alias:</p><pre tabindex=0><code>alias git_init=&#39;git init &amp;&amp; git checkout -b main&#39;
</code></pre><p>Don&rsquo;t forget to source your changes to your shell. For bash you can run: <code>source ~/.bash_profile</code>.</p><p>Which gives you the ability to run either <code>git main</code> or <code>git_init</code> to start a new repo with <code>main</code> as the default branch.</p><h2 id=github>Github
<a class=anchor href=#github>#</a></h2><p>The branch protection rules in Github will need to be modified for each repo that you touch.</p><h2 id=circleci-changes>CircleCI Changes
<a class=anchor href=#circleci-changes>#</a></h2><p>In the UI ensure that the pipeline is filtering for All Branches instead of just master. The new builds should show up automatically. Historical information for old builds is not destroyed in CircleCI during this change. So no changes should be required.</p><p>When things don&rsquo;t work there are steps to re-sync the project that should be used as a last resort:</p><p>VCP Default Branch Isn&rsquo;t Reflected on CircleCI
CircleCI Doesn&rsquo;t Notice when github default branch is updated</p><h2 id=terraform-registry>Terraform Registry
<a class=anchor href=#terraform-registry>#</a></h2><p>Terraform registry uses git tags to pull from github. As long as <code>main</code> is a reflection of <code>master</code> then no changes are needed for the terraform registry.</p><h2 id=ide-changes>IDE Changes
<a class=anchor href=#ide-changes>#</a></h2><p>Any ID that handles git integrations should be able to handle this change. Consider adding <code>main</code> to the set of protected branches if your editor allows for that.</p><h2 id=tooling-changes>Tooling Changes
<a class=anchor href=#tooling-changes>#</a></h2><p>As a quick reference for some tools that need to be updated here is a non-exhaustive list:</p><ul><li><a href=https://danger.systems/js/>DangerJS</a> should be updated to at least <code>v10.3.0</code> (see the
<a href=https://github.com/danger/danger-js/issues/1057>PR</a>)</li><li><a href=https://git-scm.com/>git</a> should be updated to at least <code>v2.28.0</code> (see the
<a href=https://github.blog/2020-07-27-highlights-from-git-2-28/#introducing-init-defaultbranch>Release Notes</a>)</li></ul><h2 id=references>References
<a class=anchor href=#references>#</a></h2><p>References:</p><ul><li><a href=https://dev.to/rhymu8354/git-renaming-the-master-branch-137b>Git Renaming the master branch</a></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/805th-Shoc/805th-Shoc.github.io/commit/68107e13639aa3571776ec70bc74c1fcf0a5a6f6 title='Last modified by Rev. Richard E. Baker | February 8, 2023' target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>February 8, 2023</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#master-to-main-branch-rename>Master to Main branch rename</a><ul><li><a href=#prereqs>Prereqs</a></li><li><a href=#instructions-to-change-default-branch-name>Instructions to change default branch name</a></li><li><a href=#future-proofing>Future proofing</a></li><li><a href=#github>Github</a></li><li><a href=#circleci-changes>CircleCI Changes</a></li><li><a href=#terraform-registry>Terraform Registry</a></li><li><a href=#ide-changes>IDE Changes</a></li><li><a href=#tooling-changes>Tooling Changes</a></li><li><a href=#references>References</a></li></ul></li></ul></nav></div></aside></main></body></html>